/*jslint strict:false, browser:true*/
/*global MBTIC:false, window:false*/

(function () {
	var setup, render, drawBackground;

	setup = function () {
		MBTIC.simpleLoader({
			rgb: 'togtfo.jpg'
		}, function (images) {
			render(images);
		});
	};

	drawBackground = function (ctx) {
		var w = ctx.canvas.width, h = ctx.canvas.height, x, y;
		ctx.fillStyle = '#fff';
		ctx.fillRect(0, 0, w, h);
		ctx.fillStyle = '#ccc';
		for (x = 0; x < w; x += 16) {
			for (y = 0; y < h; y += 16) {
				ctx.fillRect(x, y, 8, 8);
				ctx.fillRect(x + 8, y + 8, 8, 8);
			}
		}
	};

	render = function (images) {
		var ctx = document.getElementById('canvas').getContext('2d'),
			rgba = MBTIC.toRgbaFromSvgClippingPathData(images.rgb,
				'M 51.071429,40.714285 C 66.734919,28.816124 93.539137,23.477285 110.71429,29.642856 C 142.53721,41.066718 152.66545,78.249998 171.59309,112.76658 C 189.01174,144.53134 214.79587,172.21356 238.57143,189.64286 C 244.47781,193.97268 253.97366,194.26774 260.35714,197.85715 C 266.20652,201.14623 270.49546,205.95125 274.59216,216.13263 C 313.52201,245.59842 377.85715,295 377.85715,295 L 382.14286,284.28571 L 375.71429,268.21429 L 370.71428,273.57142 L 360.71429,250.71429 L 370.71429,262.14286 L 374.28571,260.71429 L 370.35714,245.71429 L 379.28571,239.28571 L 376.78571,225.71428 C 395.8943,212.74386 414.18966,200.4491 440.35715,198.57143 C 473.04528,196.22587 515.0343,189.92383 555,196.07142 L 527.14286,231.07143 L 567.14285,240.71429 L 537.5,276.07143 L 551.07143,284.64286 L 510,311.42857 L 522.5,320.35715 L 489.64286,320 L 494.64286,333.92857 L 482.5,330 L 480.71428,339.64286 C 480.71428,339.64286 505.24253,368.06352 513.21428,381.42857 C 536.76604,420.91428 575.71429,522.14286 575.71429,522.14286 L 397.5,525 L 402.14286,429.28571 L 394.28571,412.14286 L 394.28571,398.57143 C 394.28571,398.57143 210.72544,370.13764 188.57143,365 C 184.08219,361.55735 176.80854,351.05659 179.28571,345 C 164.43418,347.74423 142.01979,346.54309 124.64285,340.71429 C 99.893274,332.41246 83.217179,313.40465 73.928572,298.21429 C 73.262782,291.62924 81.855364,282.32665 82.142858,275.71428 C 78.3363,264.69366 72.31342,256.26929 73.928571,245.35714 C 75.796925,232.73431 90.129753,219.17963 97.857143,208.21429 C 72.778008,192.36852 31.5867,165.85381 24.642857,140 C 9.8722903,85.005172 26.153,59.6426 51.071429,40.714285 z');
		drawBackground(ctx);
		ctx.drawImage(rgba, 0, 0);
	};

	window.onload = setup;
}());